# RCalc
Приложение для расчёта заработной платы оператора станков с ПУ предприятия АО 'Обуховский завод’ или любого другого предприятия, любой другой станочной профессии, подразумевающей сдельную оплату труда.

## Как работает
Пользователь заполняет небольшую табличку с исходными данными необходимыми для расчёта.После ввода минимально необходимых данных, кнопка генерации зарплатного листа становится активной.
После нажатия кнопки генерации на экране появляется SVG изображение зарплатного листка в котором отображены результаты всех произведённых расчётов.

## Реализованные возможности
 - Генерация SVG изображения с текущими расчётами заработной платы.
 - Генерация QR кода содержащего ссылку на текущий расчёт заработной платы.
 - Возможность делиться ссылками на производимые расчёты.
 - Возможность скачивать текущий расчёт заработной платы в формате PDF или SVG.

## Вводимые данные
+ __СТАВКА__  – Тарифная ставка руб/час.
+ __ГРАФИК__ – Рабочий график, представляет выбор между двумя вариантами 14, и 16 график.
	- 14 график – скользящий график типа  день – день.
	- 16 график – скользящий график типа  день – ночь.
+ __ДНЕВНЫХ СМЕН / НОЧНЫХ СМЕН (без учёта сверхурочных)__ – Количество действительно отработанных дневных/ночных смен без учёта сверхурочных  смен.
+ __ДНЕВНЫХ СМЕН / НОЧНЫХ СМЕН (по графику)__ – Количество потенциальных смен в месяце, вне зависимости от количества отработанных. Заполняется автоматически при вводе действительно отработанных смен, необходимо редактировать при несовпадении отработанных смен (больничный, за свой счёт и т.п.) и смен по графику.
+ __ДОПОЛНИТЕЛЬНЫЕ СМЕНЫ__ – Раскрывающийся список с дополнительными вводными данными для учёта дополнительных смен.
	- __СВЕРХУРОЧНЫХ (дневных смен / ночных смен)__ – Количество дневных/ночных сверхурочных смен.
	- __ПРАЗДНИЧНЫХ (дневных смен / ночных смен)__ – Количество праздничных дней входящих в состав отработанных смен.
+ __ВЫПЛАТЫ ИЗ ФНП__ (фонд начальника подразделения) – Индивидуальная выплата, имеет фиксированный размер, никак не высчитывается, вводится по факту.
+ __МНОГОСТАНОЧКА__ – Наличие или отсутствие многостаночного обслуживания. При активированной опции многостаночное обслуживание считается за 2 станка.
+ __ВЫСЛУГА__ – Премия выплачиваемая исходя из стажа работника.
+ __РАЗРЯД__ – Премия выплачиваемая исходя из разряда работника.
+ __КУЛЬТУРА__ – Премия за культуру производства, представляет собой процент от сдельной оплаты труда и оплаты за многостаночное обслуживание (если она есть).
+ __КОЭФФИЦИЕНТ__ – Коэффициент выполнения норм. Отношение нормированной трудоёмкости к фактической трудоёмкости. Максимальный коэффициент при многостаночном обслуживании – 2.0, без – 1.2.
+ __АВАНС__ – Индивидуальный размер выплаты перед основной зарплатой.

## Расчёты

### Статичные данные:
Дневная смена с 07:20 до 20:00, обеды 11:30 – 12:10 и 16:00 – 16:18\
Ночная смена с 20:00 до 07:30 обед 00:00 – 00:30\
Вечерними часами считаются часы с 16:18 до 22:00\
Ночными часами считаются часы с 22:00 до 06:00
|Описание                                                                                |   id   |Значение|
|----------------------------------------------------------------------------------------|--------|--------|
|Длительность дневной смены ( часов )                                                    |__mdh__ |   11.7 |
|Длительность ночной смены ( часов )                                                     |__ndh__ |   11   |
|Дневные вечерние часы <br> (количество вечерних часов в дневной смене)                  |__deh__ |   3.7  |
|Ночные вечерние часы <br> (количество вечерних часов в ночной смене)                    |__neh__ |   2    |
|Ночные часы <br> (количество ночных часов в ночной смене)                               |__nnh__ |   7.5  |
|Ночные сверхурочные часы <br> (Количество ночных часов в <br> ночной сверхурочной смене)|__onnh__|   8    |
|Налог с физического лица (%)                                                            |__nfl__ |   13   |

### Исходные данные вводимые пользователем:
|Название                                     |   id   |
|---------------------------------------------|--------|
|СТАВКА                                       |__rate__|
|ГРАФИК                                       |__sch__ |
|ДНЕВНЫХ СМЕН (без учёта сверхурочных)        |__md__  |
|НОЧНЫХ СМЕН (без учёта сверхурочных)         |__nd__  |
|ДНЕВНЫХ СМЕН (по графику)                    |__mdg__ |
|НОЧНЫХ СМЕН (по графику)                     |__ndg__ |
|СВЕРХУРОЧНЫХ (дневных смен )                 |__omd__ |
|СВЕРХУРОЧНЫХ (ночных смен)                   |__ond__ |
|ПРАЗДНИЧНЫХ (дневных смен)                   |__mhd__ |
|ПРАЗДНИЧНЫХ (ночных смен)                    |__nhd__ |
|ВЫПЛАТЫ ИЗ ФНП <br> (фонд нач. подразделения)|__fnp__ |
|МНОГОСТАНОЧКА                                |__ms__  |
|ВЫСЛУГА                                      |__lms__ |
|РАЗРЯД                                       |__lvl__ |
|КУЛЬТУРА                                     |__cul__ |
|КОЭФФИЦИЕНТ                                  |__coe__ |
|АВАНС                                        |__prp__ |

### Расчёты дней :
Все дневные смены (включая сверхурочные) – __allmd__ = md + omd\
Все ночные смены (включая сверхурочные) – __allnd__ = nd + ond\
Все смены без сверхурочных – __alld0__ = md + nd\
Все смены со сверхурочными – __alld__ = allmd + allnd\
Сверхурочные смены – __allod__ = omd + ond\
Праздничные смены – __allhd__ = mhd + nhd\
Дни надбавки за разряд (все смены без сверхурочных и праздничных) – __wdlvl__ = alld0 - allhd

### Расчёты часов:
Все часы (кроме сверхурочных) – __wh0__ = md * mdh + nd * ndh\
Все часы (включая сверхурочные) – __wh__ = allmd * mdh + allnd * ndh\
Все вечерние часы – __eh__ = allmd * deh + allnd * neh\
Все ночные часы – __nh__ = nd * nnh + ond * onnh\
Станочные часы (сделка) – __pwh__ = wh * coe\
Многостаночные часы – __msh__ = wh * (coe - 1)\
Праздничные часы – __hdh__ = mhd * mdh + nhd * ndh\
Сверхурочные часы – __oh__ = omd * mdh + ond * ndh\
Часы за разряд – __whlvl__ = wh – (((mhd + omd) * mdh) + ((nhd + ond) * ndh))

### Расчёты денег: 
- [012] Премия рабочим – __wa__ = 
	+ При многостаночности  = (pw + msm) * 0.3
	+ Без многостаночности = pw * 0.3
- [015] Выплаты из фонда нач. подразделения = __fnp__
- [021] Сдельная оплата труда – __pw__ =
	+ При многостаночности = wh * rate
	+ Без многостаночности = pwh * rate
- [024] Доплата за вечерние часы (только 16 график) – __ehm__ = eh * (rate * 0.2)
- [025] Доплата за ночные часы – __nhm__ = nh * (rate * 0.4)
- [038] Доплата за работу в выходные дни – __ohm__ = oh * rate
- [041] Премия за культуру производства – __culm__ = 
	+ При многостаночности  = (pw + msm) * (cul / 100)
	+ Без многостаночности = pw * (cul / 100)
- [051] Доплата за работу в праздничные дни – __hdm__ = hdh * rate
- [061] Вознаграждение за выслугу лет = __lms__
- [128] Оплата за многостаночное обслуживание – __msm__ =( msh * 0.75) * rate

 - Общая заработная плата без учёта налога – __zpd__ = ohm + hdm + pw + ehm + nhm + lms + msm + fnp + wa + culm
 - Налог – __tax__ = zpd * (nfl / 100)
 - Удержано – __wit__ = tax+prp
 - Общая заработная плата с учётом налога – __zpc__ = zpd – tax
 - Зарплата с вычетом аванса – __zp__ = zpc - prp

## Используемые библиотеки
Проект написан на чистом HTML CSS и JavaScript, однако использует некоторые дополнительные библиотеки.
### Список библиотек:
 - [qrcode-svg](https://github.com/papnkukn/qrcode-svg)
 - [Detect.js](https://github.com/darcyclarke/Detect.js)
 - [pdfkit](https://github.com/foliojs/pdfkit)
 - [SVG-to-PDFKit](https://github.com/alafr/SVG-to-PDFKit)
 - [blob-stream](https://github.com/devongovett/blob-stream)
